<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="IconCrafter.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="clr-namespace:IconCrafter"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="IconCrafter - PNG转ICO工具">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- 应用图标和标题 -->
        <StackPanel Grid.Row="0" Orientation="Vertical" HorizontalAlignment="Center" Margin="0,0,0,20">
            <Image x:Name="IcoImage" Source="Assets/ico.png" Width="64" Height="64" Margin="0,0,0,10"/>
            <TextBlock Text="IconCrafter" FontSize="24" FontWeight="Bold" HorizontalAlignment="Center"/>
        </StackPanel>

        <!-- 文件选择区域 -->
        <StackPanel Grid.Row="1" Margin="0,0,0,20">
            <TextBlock Text="选择PNG图片:" FontWeight="SemiBold" Margin="0,0,0,10"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="InputFileTextBox" Grid.Column="0" Text="{Binding InputFilePath, FallbackValue='请选择PNG图片文件...'}" 
                         IsReadOnly="True" Margin="0,0,10,0"/>
                <Button x:Name="BrowseButton" Grid.Column="1" Content="浏览" Command="{Binding BrowseCommand}"/>
            </Grid>
        </StackPanel>

        <!-- 尺寸选择区域 -->
        <StackPanel Grid.Row="2" Margin="0,0,0,20">
            <TextBlock Text="选择ICO尺寸:" FontWeight="SemiBold" Margin="0,0,0,10"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                <StackPanel Grid.Column="0">
                    <CheckBox x:Name="Size32CheckBox" Content="32x32" IsChecked="{Binding Size32Selected}"/>
                    <CheckBox x:Name="Size64CheckBox" Content="64x64" IsChecked="{Binding Size64Selected}"/>
                </StackPanel>
                <StackPanel Grid.Column="1">
                    <CheckBox x:Name="Size128CheckBox" Content="128x128" IsChecked="{Binding Size128Selected}"/>
                    <CheckBox x:Name="Size256CheckBox" Content="256x256" IsChecked="{Binding Size256Selected}"/>
                </StackPanel>
            </Grid>
        </StackPanel>

        <!-- 输出选项 -->
        <StackPanel Grid.Row="3" Margin="0,0,0,20">
            <TextBlock Text="输出选项:" FontWeight="SemiBold" Margin="0,0,0,10"/>
            <RadioButton x:Name="SingleFileRadio" Content="生成单个包含所有尺寸的ICO文件" IsChecked="{Binding IsSingleFile}" GroupName="OutputType"/>
            <RadioButton x:Name="MultipleFilesRadio" Content="为每个尺寸生成单独的ICO文件" IsChecked="{Binding IsSingleFile, Converter={x:Static local:Converters.InverseBooleanConverter}}" GroupName="OutputType"/>
        </StackPanel>

        <!-- 输出目录 -->
        <StackPanel Grid.Row="4" Margin="0,0,0,20">
            <TextBlock Text="输出目录:" FontWeight="SemiBold" Margin="0,0,0,10"/>
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBox x:Name="OutputDirTextBox" Grid.Column="0" Text="{Binding OutputDirectory, FallbackValue='默认为原图片目录'}" 
                         Margin="0,0,10,0"/>
                <Button x:Name="OutputDirButton" Grid.Column="1" Content="选择目录" Command="{Binding SelectOutputDirectoryCommand}"/>
            </Grid>
        </StackPanel>

        <!-- 进度指示器 -->
        <ProgressBar x:Name="ConversionProgress" Grid.Row="5" 
                     Visibility="{Binding IsConverting, Converter={x:Static local:Converters.BooleanToVisibilityConverter}}"
                     IsIndeterminate="True" Height="4" Margin="0,10"/>
        
        <!-- 转换按钮 -->
        <Button x:Name="ConvertButton" Grid.Row="6" Content="开始转换" 
                HorizontalAlignment="Center" Padding="30,10" FontSize="16"
                Command="{Binding ConvertCommand}" IsEnabled="{Binding CanConvert}"/>

        <!-- 状态信息 -->
        <ScrollViewer Grid.Row="7" Margin="0,20,0,0">
            <TextBlock x:Name="StatusTextBlock" Text="{Binding StatusMessage}" 
                       TextWrapping="Wrap" FontFamily="Consolas"/>
        </ScrollViewer>
    </Grid>
</Window>
